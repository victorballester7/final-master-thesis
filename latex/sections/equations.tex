\documentclass[../main.tex]{subfiles}

\begin{document}
\section{Theoretical background}
The primary focus of this work is the integration of the incompressible Navier-Stokes equations with a random forcing term:
\begin{align}
	\label{eq:navier-stokes}\partial_t \vf{u} + (\vf{u} \cdot \grad) \vf{u} & = -\grad p + \nu\laplacian \vf{u} + \vf{f} \\
	\label{eq:incompressibility}\divp{\vf{u}}                               & = 0
\end{align}
where $\vf{u}$ is the velocity field, $p$ is the pressure, $\nu$ is the kinematic viscosity, and $\vf{f}$ is a random forcing term. The second equation is called	\emph{incompressibility condition} and it translates the fact that the fluid cannot be compressed.
The forcing term is chosen to be Gaussian for the stream function formulation, which is detailed below.

\subsection{Stream function formulation}
In~\cite{Batchelor2000}, a new variable is introduced in order to simplify the integration of the 2D incompressible Navier-Stokes equations. This quantity, called \emph{stream function} and denoted by $\psi$, is defined as the flow rate across a given line. More accurately, if $\mathcal{C}$ is a curve joining two points $O$ (fixed) and $P=(x,y)$, the stream function streams function a function f the coordinates of the point $P$ is then
\begin{equation}
	\psi(x,y) -\psi_0 = \int_{\mathcal{C}} \vf{u}^\perp \cdot \dd{\vf{s}}= \int_{O}^{P} -v \dd{x} + u \dd{y}
\end{equation}
where $\vf{u} = (u,v)$ is the velocity field, $\dd{\vf{s}}=(\dd{x},\dd{y})$ is the tangent vector to the curve, and $\psi_0$ is a reference value. In differential form, it can be written as
\begin{equation}
	\dd{\psi} = -v \dd{x} + u \dd{y} = \pdv{\psi}{x} \dd{x} + \pdv{\psi}{y} \dd{y}
\end{equation}
where the last equality follows from the exact differential property. Thus, one obtain the following useful relations:
\begin{equation}
	u = \pdv{\psi}{y} \quad \text{and} \quad v = -\pdv{\psi}{x}
\end{equation}
Note the arbitrary choice of $\vf{u}^\perp$ in the definition of the stream function. In the present work, the choice is made to be $\vf{u}^\perp = (-v,u)$, in order to keep the same sign convention as in similar works (\cite{2dturbulence,alexakisLONG}). The formulation with the alternative stream function $\psi':=-\psi$ is sometimes used in other fields of fluid dynamics, mostly in meteorology and oceanography.

Note that using this definition, the incompressible condition $\divp \vf{u}=0$ is automatically satisfied. Finally, introducing the scalar vorticity $\omega := \rotp \vf{u} = \pdv{v}{x} - \pdv{u}{y}=-\laplacian \psi$, one can rewrite the Navier-stokes equations in terms of the vorticity:
\begin{align}
	\partial_t \omega + (\vf{u} \cdot \grad) \omega & = \nu \laplacian \omega + f_\omega \\
	\divp{\vf{\omega}}                              & = 0
\end{align}
where the rotational has been taken to both sides of \cref{eq:navier-stokes,eq:incompressibility} and some basic vector have been used. The main objects of interest in the vorticity formulation are the \emph{vortices}, which according to \cite{Saffman} are the local regions on the plane with non vanishing vorticity and surrounded with an irrotational flow.

Now, using the relation between the stream function and the vorticity one obtains:
\begin{equation}\label{eq:streamfunction}
	\partial_t \psi + \laplacian^{-1} (\vf{u} \cdot \grad) \laplacian \psi = \nu \laplacian \psi + f_\psi
\end{equation}
The reader may quickly notice that this equation seems more complicated than the first one. However, when transforming the equation to Fourier space, it becomes much more simply (see \cref{eq:streamfunction_fourier}), with the advantage of having a scalar function as the main unknown variable and removing the incompressible condition.

The forcing term is assumed to be Gaussian, in particular it is taken of the form:
\begin{equation}
	f_\psi(x,y) = f_0\sum_{i=1}^{10} A_i \expp\left(-\frac{k_\ell^2}{2}\left[{(x-x_{i,1})}^2 + {(y-y_{i,1})}^2\right]\right) - A_i\expp\left(-\frac{k_\ell^2}{2}\left[{(x-x_{i,2})}^2 + {(y-y_{i,2})}^2\right]\right)
\end{equation}
With this forcing we are introducing 10 pairs of vortices with opposite vorticity in order not to introduce a nonzero momentum to the system. The quantities $A_i$ follow a uniform distribution between 0 and 1; $f_0\propto 1/\sqrt{\Delta t}$ is a prescribed maximum amplitude for the forcing term; $k_\ell$ quantifies the size of the vortices (thought in Fourier space) so that the vortices injected have size $\sim 1/k_\ell$, and the coordinates $x_{i,k}$, $y_{i,k}$, for $k=1,2$ are random variables that position the vortices inside a small disk of radius $k_r$ centered at the origin such that the density of vortices is (almost) constant. To be more clear, if we express the coordinates of the vortices in polar coordinates, the angular variable is uniformly distributed between 0 and $2\pi$ and the radial variable follows a distribution $\sqrt{\mathcal{U}(0,\pi/k_r)}$ where $\mathcal{U}(a,b)$ is the uniform distribution between $a$ and $b$. Indeed, one can easily check that the probability of finding a vortex inside a disk of ring $(r-\dd{r},r)$ does not depend on $r$:
\begin{equation}
	\Prob(r-\dd{r} < \sqrt{\mathcal{U}(0,\pi/k_r)} \leq r) = \int_{{(r-\dd{r})}^2}^{r^2} \frac{1}{\pi/k_r} \dd{s} \simeq C r \dd{r} + \mathcal{O}(\dd{r}^2)
\end{equation}
Thus, since the area of the ring $\{(x,y) \in \RR^2 : r-\dd{r} < \sqrt{x^2+y^2} \leq r\}$ is proportional to $r \dd{r}$ at first order, the density of vortices is constant up to a small error of order $\dd{r}$.
\subsection{Fourier space}
The \emph{Fourier transform} (FT) of a function $f:\RR^2 \to \RR$ is defined as
\begin{equation}
	\widehat{f}(\vf{\xi}) = \int_{\RR^2} f(\vf{x}) \exp{-\ii \vf{\xi} \cdot \vf{x}} \dd{\vf{x}}
\end{equation}
for all $\vf\xi\in\RR^2$ and its discrete version (DFT) for a square domain with $N$ points in each direction is
\begin{equation}
	\widehat{f}(\vf{k}) = \sum_{\vf{n}\in\vf{N}} \vf{f}_{\vf{n}} \exp{-\ii \vf{k} \cdot \vf{f}_{\vf{n}}/N}
\end{equation}
where $\vf{N} = {\{0,1,\ldots,N-1\}}^2$ is the set of points in the Fourier grid, $\vf{f}_{\vf{n}}$ is the value of the function in the physical space at the point $\vf{n}$, and $\vf{k} = (k_x,k_y)$ is the wave vector.

Taking the Fourier transform on both sides of \cref{eq:streamfunction} and using the well-known properties of the Fourier transform, one obtains:
\begin{equation}\label{eq:streamfunction_fourier}
	\dv{}{t}\widehat{\psi} - k^{-2} \widehat{(\vf{u}\cdot \grad) \laplacian \psi}= -\nu k^2 \widehat{\psi} + \widehat{f_\psi}
\end{equation}
where $k:=\abs{\vf{k}}$. Note that the non-linear term in the above equation has not been simplified. This is because in the simulation that term is backward-transformed to the physical space, computed, and then transformed back to the Fourier space, as it is less expensive than computing the non-linear term in Fourier space.

\subsection{Reynolds number}
The Reynolds number is a dimensionless quantity that characterizes the ratio of inertial forces to viscous forces in a fluid. It is usually defined as $\Re:= U L/\nu$, where $U$ is a characteristic velocity of the flow, $L$ is the characteristic length scale associated to it and $\nu$ is the kinematic viscosity. In the cases where there is no control on the injection velocity, but on the rate of energy injection $\epsilon$, this equation is not useful anymore. To derive an alternative equation, the scaling theory of Kolmogorov is used (\cite{Frisch}). Let $\epsilon_\ell \sim u_\ell^2 / \tau_\ell$ be the rate of change of energy at the scale $\ell$, where $u_\ell$ is the velocity at that scale and $\tau_\ell$ is the characteristic time at that scale. Using that $\tau_\ell\sim \ell/u_\ell$, one obtains $\epsilon_\ell \sim u_\ell^3/\ell$. Assuming that the energy transferred from the scale $\ell$ to smaller scales is the same as the energy received by the scale $\ell$ from larger scales (that is, the flux of energy across scales is constant), one obtains that the value $\epsilon$ does not depend on $L$ and moreover $\epsilon \sim U^3/L$, i.e.\ $U \sim {(\epsilon L)}^{1/3}$. Thus, we get a new formula for the Reynolds number:
\begin{equation}
	\Re=\frac{\epsilon^{1/3} L^{4/3}}{\nu}
\end{equation}
In the present work, the length scale $L$ is determined by the size of the vortices injected in the disk, which in this case is $L=1/k_\ell$.

ACABAR AIXOOOOOOOOOOOOOO
\begin{equation}
	\epsilon = f_0^2 \frac{4 \pi^2}{\pi (\pi / k_r)^2}
\end{equation}
\begin{equation}\label{eq:reynolds}
	\Re = \frac{{\left( f_0^2\cdot\frac{4 k_r^2}{\pi} \right)}^{1/3} k_\ell^{-4/3}}{\nu}
\end{equation}

\subsection{Point-vortex model}
The study has accomplished another simulation, far from the Navier-Stokes equations, but aiming to obtain qualitatively and quantitatively similar results. This simulation is based on the point-vortex model, which is a simplified version of the dynamics of a set of vortices.

More precisely, in the point-vortex model that follows, the viscous term is neglected. Thus, this problem aims to mimic in some way the dynamics of the Navier-Stokes equations as $\nu \to 0$ (or equivalently $\Re\to\infty$, see \cref{eq:reynolds}). Moreover, the vortices are considered as point-like objects, that is to say, being the vorticity singular at the position of the vortices. Because of that, the vortices are characterized by their circulation
\begin{equation}
	\Gamma = \lim_{\diam(\mathcal{C})\to 0} \int_{\mathcal{C}} \vf{u} \cdot \dd{\vf{s}}
\end{equation}
where $\mathcal{C}$ is a curve surrounding the vortex. In those conditions and in absence of external forces, the vorticity field $\omega$ is only advected and its evolution in time is described by the following transport equation:
\begin{equation}
	\partial_t \omega + (\vf{u} \cdot \grad) \omega = 0
\end{equation}
together with the incompressible condition $\divp \vf{u}=0$ (\cite{pointvortexmath}). Here $\vf{u}$ is the velocity field generated by the vortices. An interesting interpretation of the vortices involves the Dirac's delta distribution. Specifically, the vorticity field generated by a point vortex located at $\vf{y}$ can be represented as a distribution of the form:
\begin{equation}\label{eq:vorticity_delta}
	\omega(\vf{x}, t) = \Gamma \delta(\vf{x}-\vf{y})
\end{equation}
where $\Gamma$ is the circulation of the vortex (\cite{Saffman}). The dynamics of $N$ point vortices in the $\RR^2$ plane are described in the following theorem:
\\
\begin{theorem}
	Consider $N$ vortices at positions $\vf{z}_1,\ldots,\vf{z}_N\in \RR^2$ and with circulations $\Gamma_1,\ldots,\Gamma_N$. Then, their evolution in time is described by the following system of ordinary differential equations (\cite{pointvortex}):
	\begin{align}
		\dot{x}_i & = -\sum_{j\neq i} \frac{\Gamma_j}{2\pi} \frac{y_i-y_j}{{(x_i-x_j)}^2+{(y_i-y_j)}^2} \\
		\dot{y}_i & = \sum_{j\neq i} \frac{\Gamma_j}{2\pi} \frac{x_i-x_j}{{(x_i-x_j)}^2+{(y_i-y_j)}^2}
	\end{align}
	for $i=1,\ldots,N$, where $\vf{z}_i=(x_i,y_i)$.
\end{theorem}
\begin{proof}
	Since there is no viscosity in the equations, each vortex is advected with the velocity field generated by all the other vortices. Now, given $\vf{f}\in \mathcal{C}^1(\RR^2,\RR^2)$ and $\vf{g}:=\rotp f$, by Biot-Savart law one can invert the curl operator using the Biot-Savart kernel (see~\cite{Griffiths}):
	\begin{equation}
		\vf{f}(\vf{x}) = (\vf{K} * \vf{g})(\vf{x}) = \int_{\RR^2} \vf{K}(\vf{x}-\vf{y}) \vf{g}(\vf{y}) \dd{\vf{y}}
	\end{equation}
	where $\displaystyle\vf{K}(x) = \frac{1}{2\pi} \frac{(-x_2,x_1)}{{\abs{\vf{x}}^2}}$ is the Biot-Savart kernel and $\vf{x}=(x_1,x_2)$. In our case, $\vf{g}$ is the vorticity field which is a sum of $\delta$'s. Thus, taking into consideration \cref{eq:vorticity_delta}, the velocity field generated by a vortex at $\vf{z}_j$ with circulation $\Gamma_j$ is:
	\begin{equation}
		\vf{u}_j(\vf{x}) = \vf{K}(\vf{x}-\vf{z}_j) \Gamma_j
	\end{equation}
	We conclude using the superposition principle.
\end{proof}
In order to closer the gap between the point-vortex model and the Navier-Stokes equations while keeping the simplicity of the former, an extra equation is added to the pair of equations above. This equation concerns the evolution of the circulations of the vortices. A drag term is added in order to mimic the energy dissipation in the Navier-Stokes equations. The form of the equation is:
\begin{equation}
	\dot{\Gamma}_i = -\alpha \Gamma_i
\end{equation}
Another aspect worth-mentioning is the numerical addition of a softening parameter $\varepsilon$ to the equation in the form:
\begin{align}
	\dot{x}_i & = -\sum_{j\neq i} \frac{\Gamma_j}{2\pi} \frac{y_i-y_j}{{(x_i-x_j)}^2+{(y_i-y_j)}^2+\varepsilon^2} \\
	\dot{y}_i & = \sum_{j\neq i} \frac{\Gamma_j}{2\pi} \frac{x_i-x_j}{{(x_i-x_j)}^2+{(y_i-y_j)}^2+\varepsilon^2}
\end{align}
This prevents the positions to blow up when two vortices get too close to each other, which in \cref{sec:results} is shown to be the common behavior of the system. The softening parameter is chosen to be $\varepsilon=0.001$, being this value small enough to not affect the dynamics of the system but large enough to prevent a numerical blow-up.

\subsection{Monitored quantities}
In order to keep track of the evolution of the system, several variables are monitored during the simulation.

For the Navier-Stokes equations, the main quantity of interest is the total energy and vorticity in the system. Since the work environment is the Fourier space (see \cref{sec:numerical}), the energy is computed as
\begin{equation}
	E = \sum_{\vf{k}\in\vf{K}} \norm{\widehat{\vf{u}}(\vf{k})}^2 = \sum_{\vf{k}\in\vf{K}} k^2 {|\widehat{\psi}(\vf{k})|}^2
\end{equation}
which by the Parseval identity is equivalent to the total energy in the physical space. Here $\vf{K} = {\{0,1,\ldots,K-1\}}^2$ is the set of points in the Fourier grid, and $K=N/3$ is the maximum wave number chosen in order to control the aliasing effects. Another important quantity worth-considering is \emph{enstrophy}, which is analogous to energy but uses vorticity instead of velocity as the primary variable. It is defined as
\begin{equation}
	\Omega = \sum_{\vf{k}\in\vf{K}} {|\widehat{\omega}(\vf{k})|}^2 = \sum_{\vf{k}\in\vf{K}} k^4 {|\widehat{\psi}(\vf{k})|}^2
\end{equation}
where the second equality follows from the relation $\omega = -\laplacian \psi$.

As the title suggests, the main purpose of this work is to study how turbulence is spread across the system. Thus, quantities relating the energy (and enstrophy) contained in rings as a function of the radius are also monitored. We denote these variables as $E_k$ and $\Omega_k$ respectively, and they are given by the following expressions:
\begin{align}
	E_k      & = \sum_{k-1<\norm{\vf{k}}\leq k} \norm{\widehat{\vf{u}}(\vf{k})}^2      \\
	\Omega_k & = \sum_{k-1<\norm{\vf{k}}\leq k} \norm{\widehat{\vf{\omega}}(\vf{k})}^2
\end{align}
where $k\in\{1,\ldots,K\}$. The quantities $E_k$ and $\Omega_k$ are then plotted as a function of $k$ in order to study the energy and enstrophy distribution across the system (see \cref{sec:results}).

Related to those two latter variables is the mean energy radius and mean enstrophy radius, which refer to an weighted average of the radius where most of the energy (and enstrophy, respectively) is contained. They are defined as
\begin{align}
	\mathcal{R}_E      & = \frac{\sum_{k=1}^{K} k^2 E_k}{\sum_{k=1}^{K} E_k}           \\
	\mathcal{R}_\Omega & = \frac{\sum_{k=1}^{K} k^2 \Omega_k}{\sum_{k=1}^{K} \Omega_k}
\end{align}
Note that since the domain is square, the sums $\sum_{k=1}^{K} E_k$ and $\sum_{k=1}^{K} \Omega_k$ are slightly less than the total energy $E$ and enstrophy $\Omega$ respectively.

Regarding the point-vortex model, the system is integrable and the following function $H$
\begin{equation}
	H = \sum_{i=1}^{N} H_i,\qquad H_i = -\frac{1}{4\pi} \sum_{j\neq i} \Gamma_j \log{\norm{\vf{z}_i-\vf{z}_j}^2}
\end{equation}
is a first integral of the system. Moreover the system is Hamiltonian, that is, it can written as:
\begin{align}
	\dot{x}_i & = \pdv{H}{y_i}  \\
	\dot{y}_i & = -\pdv{H}{x_i}
\end{align}
At first sight, the reader may notice that function $H$ is singular when two vortices get too close to each other. Although one could try to create a function $f(H)$ that is regular in the whole domain and has a shape according the physical intuition while keeping the properties of a first integral, in this work we opted for another approach to mimic the energy and enstrophy profiles for the Navier-Stokes equation.

The idea explored here relies on counting the number of point vortices in rings and compare the density distribution with the respective functions $E_k$ and $\Omega_k$, once transformed back to the physical space.

\end{document}
