\documentclass[../main.tex]{subfiles}

\begin{document}
\section{Theoretical background}\label{sec:equations}
The primary focus of this work is the integration of the incompressible Navier-Stokes equations with a random forcing term:
\begin{align}
	\label{eq:navier-stokes}\partial_t \vf{u} + (\vf{u} \cdot \grad) \vf{u} & = -\grad p + \nu\laplacian \vf{u} + f_0\vf{f} \\
	\label{eq:incompressibility}\divp{\vf{u}}                               & = 0
\end{align}
where $\vf{u}$ is the velocity field, $p$ is the pressure, $\nu$ is the kinematic viscosity, and $f_0\vf{f}$ is a random forcing term satisfying $\divp{\vf{f}}=0$. For the sake of clarity and simplicity the amplitude factor $f_0$ of the forcing have been factor out from the force itself. The second equation is called	\emph{incompressibility condition} and translates the fact that the fluid cannot be compressed. The forcing term is chosen to be Gaussian for the vorticity formulation, which is detailed below. Throughout the project the density of the fluid is assumed to be constant and equal to 1.

\subsection{Stream function formulation}
In~\cite{Batchelor2000}, a new variable is introduced in order to simplify the integration of the 2D incompressible Navier-Stokes equations. This quantity, called \emph{stream function} and denoted by $\psi$, is defined as the flow rate across a given line. More accurately, if $\mathcal{C}$ is a curve joining two points $O$ (fixed) and $P=(x,y)$, the stream function as a function of the coordinates of the point $P$ is then
\begin{equation}
	\psi(x,y) -\psi_0 = \int_{\mathcal{C}} \vf{u}^\perp \cdot \dd{\vf{s}}= \int_{O}^{P} -v \dd{x} + u \dd{y}
\end{equation}
where $\vf{u} = (u,v)$ is the velocity field, $\dd{\vf{s}}=(\dd{x},\dd{y})$ is the tangent vector to the curve, and $\psi_0$ is a reference value. In differential form, it can be written as
\begin{equation}
	\dd{\psi} = -v \dd{x} + u \dd{y} = \pdv{\psi}{x} \dd{x} + \pdv{\psi}{y} \dd{y}
\end{equation}
where the last equality follows from the exact differential property. Thus, one obtains the following useful relations:
\begin{equation}
	u = \pdv{\psi}{y} \quad \text{and} \quad v = -\pdv{\psi}{x}
\end{equation}
Note the arbitrary choice of $\vf{u}^\perp$ in the definition of the stream function. In the present work, the choice is made to be $\vf{u}^\perp = (-v,u)$, in order to keep the same sign convention as in similar works (\cite{2dturbulence,alexakisLONG}). The formulation with the alternative stream function $\psi':=-\psi$ is sometimes used in other fields of fluid dynamics, mostly in meteorology and oceanography.

Note that using this definition, the incompressible condition $\divp \vf{u}=0$ is automatically satisfied. Finally, introducing the scalar vorticity $\omega := \rotp \vf{u} = \pdv{v}{x} - \pdv{u}{y}=-\laplacian \psi$, one can rewrite the Navier-Stokes equations in terms of the this latter variable:
\begin{align}
	\partial_t \omega + (\vf{u} \cdot \grad) \omega & = \nu \laplacian \omega + f_0f_\omega \\
	\divp{\vf{\omega}}                              & = 0
\end{align}
where the rotational has been taken to both sides of \cref{eq:navier-stokes,eq:incompressibility} and basic vector identities have been used. The main objects of interest in the vorticity formulation are the \emph{vortices} (see \cref{fig:vortices_evo}), which according to~\cite{Saffman} are the local regions on the plane with non vanishing vorticity and surrounded with an irrotational flow.

Now, using the relation between the stream function and the vorticity one obtains:
\begin{equation}\label{eq:streamfunction}
	\partial_t \psi + \laplacian^{-1} (\vf{u} \cdot \grad) \laplacian \psi = \nu \laplacian \psi + f_0f_\psi
\end{equation}
The reader may quickly observe that this equation appears to be more complicated than the first one. However, when transforming the equation to Fourier space, it becomes much more simpler (see \cref{eq:streamfunction_fourier}), with the advantage of having a scalar function as the main unknown variable (as opposed to the velocity formulation) and removing the incompressible condition (as opposed to the vorticity formulation), which is implicit in the definition of the stream function.

The forcing term is assumed to be Gaussian, in particular it is taken of the form:
\begin{equation}
	f_\omega(x,y) = \sum_{i=1}^{10} A_i \expp\left(-\frac{k_\ell^2}{2}\left[{(x-x_{i,1})}^2 + {(y-y_{i,1})}^2\right]\right) - A_i\expp\left(-\frac{k_\ell^2}{2}\left[{(x-x_{i,2})}^2 + {(y-y_{i,2})}^2\right]\right)
\end{equation}
The quantities $A_i$ follow a uniform distribution between 0 and 1; $k_\ell$ quantifies the size of the vortices (thought in Fourier space) so that the vortices injected have size $\sim 1/k_\ell$, and the coordinates $x_{i,j}$, $y_{i,j}$, for $j=1,2$ are random variables that position the vortices inside a small disk of radius $k_r$ centered at the origin such that the density of vortices is (almost) constant. To be more clear, if one expresses the coordinates of the vortices in polar coordinates, the angular variable is uniformly distributed between 0 and $2\pi$ and the radial variable follows a distribution $\sqrt{\mathcal{U}(0,\pi/k_r)}$ where $\mathcal{U}(a,b)$ is the uniform distribution between $a$ and $b$. Indeed, one can easily check that the probability of finding a vortex inside a thin annulus within the perturbation region does not depend on the radius of the annulus $r$:
\begin{equation}
	\Prob\left(r-\dd{r} < \sqrt{\mathcal{U}(0,\pi/k_r)} \leq r\right) = \int_{{(r-\dd{r})}^2}^{r^2} \frac{1}{\pi/k_r} \dd{s} \simeq C r \dd{r} + \mathcal{O}(\dd{r}^2)
\end{equation}
Thus, since the area of the annulus $\{(x,y) \in \RR^2 : r-\dd{r} < \sqrt{x^2+y^2} \leq r\}$ is proportional to $r \dd{r}$ at first order, the density of vortices is constant, up to a small error of order $\dd{r}$, throughout the perturbation region.

With this forcing the aim is to introduce 10 pairs of vortices with opposite vorticity in a inhomogeneous way which a priori may seem to introduce a non-zero momentum to the system. To correct that, the first Fourier coefficient is set to zero once transformed the forcing term to Fourier space. This implies that the actual force differs up to a constant factor from the one given above, which from now on it will be assumed that this factor is implicit in $f_\omega$, that is, $\Exp(f_\omega) = 0$.

The amplitude of the forcing is controlled by the parameter $f_0$, which is chosen such that injection rate of energy remains constant and equal to 1. Because of that it has an implicit dependence on time, as explained below.

Forward-transforming $f_\omega$ to Fourier space, from the relation $\omega = -\laplacian \psi$, one can easily get $\widehat{f_\psi}$ by dividing by $k^2$ each mode of $\widehat{f_\omega}$, being $k$ the norm value of the wave vector.

\subsection{Fourier space}
The \emph{Fourier transform} (FT) of a function $f:\RR^2 \to \RR$ is defined as
\begin{equation}
	\widehat{f}(\vf{\xi}) = \int_{\RR^2} f(\vf{x}) \exp{-\ii \vf{\xi} \cdot \vf{x}} \dd{\vf{x}}
\end{equation}
for all $\vf\xi\in\RR^2$ and its discrete version (DFT) for a square domain with $N$ points in each direction is
\begin{equation}
	\widehat{f}(\vf{k}) = \sum_{\vf{n}\in\vf{N}} f_{\vf{n}} \exp{-\ii \vf{k} \cdot \vf{n} / N}
\end{equation}
where $\vf{N} = {\{0,1,\ldots,N-1\}}^2$ is the set of points in the Fourier grid, $f_{\vf{n}}$ is the value of the function in the physical space at point $\vf{n}$, and $\vf{k} = (k_x,k_y)$ is the wave vector.

Taking the Fourier transform on both sides of \cref{eq:streamfunction} and using the well-known properties of the Fourier transform, one obtains:
\begin{equation}\label{eq:streamfunction_fourier}
	\dv{}{t}\widehat{\psi} - k^{-2} \widehat{(\vf{u}\cdot \grad) \laplacian \psi}= -\nu k^2 \widehat{\psi} + \widehat{f_\psi}
\end{equation}
where $k:=\norm{\vf{k}}$. Note that the non-linear term in the above equation has not been simplified. This is because in the simulation that term is backward-transformed to the physical space, computed, and then transformed back to the Fourier space, as it is less expensive and simpler than computing the non-linear term in Fourier space.

\subsection{Reynolds number}
The Reynolds number is a dimensionless quantity that characterizes the ratio of inertial forces to viscous forces in a fluid. It is usually defined as $\Re:= U L/\nu$, where $U$ is a characteristic velocity of the flow, $L$ is the characteristic length scale associated to it and $\nu$ is the kinematic viscosity. In the cases where there is no control on the injection velocity, but instead one can control the rate of energy injection $\epsilon$, this equation is not useful anymore. To derive an alternative equation, the scaling theory of Kolmogorov is used (\cite{Frisch}). Let $\epsilon_\ell \sim u_\ell^2 / \tau_\ell$ be the rate of change of energy at the scale $\ell$, where $u_\ell$ is the typical velocity at that scale and $\tau_\ell$ is the characteristic time at that scale. Using that $\tau_\ell\sim \ell/u_\ell$, one obtains $\epsilon_\ell \sim u_\ell^3/\ell$. Assuming that the energy transferred from the scale $\ell$ to smaller scales is the same as the energy received by the scale $\ell$ from larger scales (that is, the flux of energy across scales is constant), one obtains that the value $\epsilon$ does not depend on $\ell$ and moreover $\epsilon \sim U^3/L$, i.e.\ $U \sim {(\epsilon L)}^{1/3}$. Thus, one obtains a new formula for the Reynolds number:
\begin{equation}
	\Re=\frac{\epsilon^{1/3} L^{4/3}}{\nu}
\end{equation}
In the present work, the length scale $L$ is determined by the size of the vortices injected in the disk, which in this case is $L=1/k_\ell$. The injection rate of energy is determined by the forcing term, as follows. The amplitude $f_0$ is time dependent and is chosen in such a way that $f_0^2$ is the rate at which energy is injected per unit of area in the domain. More precisely, the amplitude of the forcing is taken as $f_0/\sqrt{\Delta t/2}$, where $\Delta t$ is the time step of the simulation, a priori varying with time.

To check that indeed this is the case, let $\vf{f}=(f_u,f_v)$ be the forcing term for the velocity equation in the physical space. Recall that since $\Exp(f_\omega)=0$ and $f_\omega = \rotp \vf{f}$, using the inversion formula for the curl (see \cref{eq:biotsavart}) and Fubini's theorem one obtains that $\Exp(f_u) = \Exp(f_v) = 0$. Thus, at time $t=T$ and time step $\Delta t$ one has, taking into account only the forcing term:
\begin{equation}
	u(\vf{x},T+\Delta t) = u(\vf{x},T) + \Delta t \:\frac{f_0}{\sqrt{\Delta t/2}}\: f_u(\vf{x}) + \cdots
\end{equation}
Squaring both sides of the equation one obtains:
\begin{equation}\label{eq:forcing_energy2}
	{u(\vf{x},T+\Delta t)}^2 = {u(\vf{x},T)}^2 + 2\sqrt{2\Delta t}\: f_0 f_u(\vf{x}) u(\vf{x},T) +2 \Delta t \: f_0^2 {f_u(\vf{x})}^2 + \mathcal{O}(\Delta t^{3/2})
\end{equation}
Taking expectation on both sides we conclude:
\begin{equation}
	\frac{{u(\vf{x},T+\Delta t)}^2 - {u(\vf{x},T)}^2}{\Delta t} = 2f_0^2\: \Exp({f_u(\vf{x})}^2)
\end{equation}
where the second term on \cref{eq:forcing_energy2} vanishes because of the zero-mean property of the forcing term. Doing a similar computation for the $v$ component, summing both equations and taking the limit $\Delta t \to 0$, one obtains the rate of energy injected in the domain.
\begin{equation}
	\pdv{E}{t}=\frac{1}{2}\pdv{}{t}(u^2 + v^2) = f_0^2\: \Exp(f_u^2 + f_v^2)
\end{equation}
The implicit assumption that $\rho=1$ in the equation ensures that it precisely represents the rate of energy injected per unit area in the domain. In the simulations at each step we adjust the amplitude of the forcing term so that its variance is equal to 1, making the rate of energy injection become $f_0^2$. Since the interest is, not on the injection rate of energy per unit of area, but on the injection rate of energy per unit of area in the forcing region, the following formula for $\epsilon$ is used:
\begin{equation}\label{eq:epsilon}
	\epsilon = f_0^2\: \frac{4 \pi^2}{\pi {(\pi / k_r)}^2}
\end{equation}
because the area of the whole domain $[0,\pi]\times[0,\pi]$ is $4\pi^2$ and the area of the forcing region is $\pi {(\pi / k_r)}^2$. Consequently the Reynolds number becomes:
\begin{equation}\label{eq:reynolds}
	\Re = \frac{{\left( f_0^2\:\frac{4 k_r^2}{\pi} \right)}^{1/3} k_\ell^{-4/3}}{\nu}
\end{equation}

\subsection{Point vortex model}
The study has accomplished another simulation, far from the Navier-Stokes equations, but aiming to obtain qualitatively and quantitatively similar results. This simulation is based on the point vortex model, which is a simplified version of the dynamics of a set of vortices.

More precisely, in the point vortex model that follows, the viscous term is neglected. Thus, this problem aims to mimic in some way the dynamics of the Navier-Stokes equations as $\nu \to 0$ (or equivalently $\Re\to\infty$, see \cref{eq:reynolds}). Moreover, vortices are considered as point-like objects, that is to say, being the vorticity singular at the position of the vortices. Because of that, the vortices are characterized by their circulation
\begin{equation}
	\Gamma = \lim_{\diam(\mathcal{C})\to 0} \int_{\mathcal{C}} \vf{u} \cdot \dd{\vf{s}}
\end{equation}
where $\mathcal{C}$ is a curve surrounding the vortex. In those conditions and in absence of external forces, the vorticity field $\omega$ is only advected and its evolution in time is described by the following transport equation:
\begin{equation}
	\partial_t \omega + (\vf{u} \cdot \grad) \omega = 0
\end{equation}
together with the incompressible condition $\divp \vf{u}=0$ (\cite{pointvortexmath}). Here $\vf{u}$ is the velocity field generated by the vortices. An interesting interpretation of the vortices involves the Dirac's delta distribution. Specifically, the vorticity field generated by a point vortex located at $\vf{y}$ can be represented as a distribution of the form:
\begin{equation}\label{eq:vorticity_delta}
	\omega(\vf{x}, t) = \Gamma \delta(\vf{x}-\vf{y})
\end{equation}
where $\Gamma$ is the circulation of the vortex (\cite{Saffman}). The dynamics of $N$ point vortices in the $\RR^2$ plane are described in the following theorem:
\\
\begin{theorem}
	Consider $N$ vortices at positions $\vf{z}_1,\ldots,\vf{z}_N\in \RR^2$ with circulations $\Gamma_1,\ldots,\Gamma_N$. Then, their evolution in time is described by the following system of ordinary differential equations (\cite{pointvortex}):
	\begin{align}\label{eq:pointvortexA}
		\dot{x}_i & = -\sum_{j\neq i} \frac{\Gamma_j}{2\pi} \frac{y_i-y_j}{{(x_i-x_j)}^2+{(y_i-y_j)}^2} \\
		\label{eq:pointvortexB}
		\dot{y}_i & = \sum_{j\neq i} \frac{\Gamma_j}{2\pi} \frac{x_i-x_j}{{(x_i-x_j)}^2+{(y_i-y_j)}^2}
	\end{align}
	for $i=1,\ldots,N$, where $\vf{z}_i=(x_i,y_i)$.
\end{theorem}
\begin{proof}
	Since there is no viscosity in the equations, each vortex is advected with the velocity field generated by all the other vortices. Now, given $\vf{f}\in \mathcal{C}^1(\RR^2,\RR^2)$ such that $\divp \vf{f} = 0$ and $g:=\rotp f$, by Biot-Savart law one can invert the curl operator using the Biot-Savart kernel (see~\cite{Griffiths}):
	\begin{equation}\label{eq:biotsavart}
		\vf{f}(\vf{x}) = (\vf{K} * g)(\vf{x}) = \int_{\RR^2} \vf{K}(\vf{x}-\vf{y}) g(\vf{y}) \dd{\vf{y}}
	\end{equation}
	where $\displaystyle\vf{K}(\vf{x}) = \frac{1}{2\pi} \frac{(-x_2,x_1)}{{\norm{\vf{x}}^2}}$ is the Biot-Savart kernel and $\vf{x}=(x_1,x_2)$. In our case, $\vf{g}$ is the vorticity field which is a sum of $\delta$'s. Thus, taking into consideration \cref{eq:vorticity_delta}, the velocity field generated by a vortex at $\vf{z}_j$ with circulation $\Gamma_j$ is:
	\begin{equation}
		\vf{u}_j(\vf{x}) = \vf{K}(\vf{x}-\vf{z}_j) \Gamma_j
	\end{equation}
	The proof concludes using the superposition principle.
\end{proof}
Another aspect worth-mentioning is the numerical addition of a softening parameter $\varepsilon$ to \cref{eq:pointvortexA,eq:pointvortexB} in order to prevent the positions of the vortices from blowing up when two vortices get too close to each other. The equations then take the following form:
\begin{align}\label{eq:pointvortexA_soft}
	\dot{x}_i & = -\sum_{j\neq i} \frac{\Gamma_j}{2\pi} \frac{y_i-y_j}{{(x_i-x_j)}^2+{(y_i-y_j)}^2+\varepsilon^2} \\
	\label{eq:pointvortexB_soft}
	\dot{y}_i & = \sum_{j\neq i} \frac{\Gamma_j}{2\pi} \frac{x_i-x_j}{{(x_i-x_j)}^2+{(y_i-y_j)}^2+\varepsilon^2}
\end{align}
This adjustment avoids the singularities of the system. These singularities occur when two vortices get too close to each other, which in \cref{sec:results} is shown to be the common behavior of the system. The softening parameter is chosen to be $\varepsilon=0.001$, being this value small enough not to affect the dynamics of the system but large enough to prevent a numerical blow-up.

In order to narrow the gap between the point vortex model and the Navier-Stokes equations while keeping the simplicity of the former, a set of vortices is added regularly in time to simulate the action of a forcing term in the equations. The point vortices are added in a similar way as in the Navier-Stokes, but this time making the addition completely symmetric to cancel out any non-zero momentum that could be introduced in the system.

\subsection{Monitored quantities}
In order to keep track of the evolution of the system, several variables are monitored during the simulation.

For the Navier-Stokes equations, the main quantity of interest is the total energy and vorticity in the system. Since the work environment is the Fourier space (see \cref{sec:numerical}), the energy is computed as
\begin{equation}
	E = \sum_{\vf{k}\in\vf{K}} \norm{\widehat{\vf{u}}(\vf{k})}^2 = \sum_{\vf{k}\in\vf{K}} k^2 {|\widehat{\psi}(\vf{k})|}^2
\end{equation}
which by the Parseval identity is equivalent to the total energy in the physical space. Here $\vf{K} = {\{0,1,\ldots,K-1\}}^2$ is the set of points in the Fourier grid, and $K=N/3$ is the maximum wave number chosen in order to control the aliasing effects. Another important quantity worth-considering is \emph{enstrophy}, which is analogous to energy but uses vorticity instead of velocity as the primary variable. It is defined as
\begin{equation}
	\Omega = \sum_{\vf{k}\in\vf{K}} {|\widehat{\omega}(\vf{k})|}^2 = \sum_{\vf{k}\in\vf{K}} k^4 {|\widehat{\psi}(\vf{k})|}^2
\end{equation}
where the second equality follows from the relation $\omega = -\laplacian \psi$.

As the title suggests, the main purpose of this work is to study how turbulence is spread across the domain. Thus, quantities relating the energy and enstrophy contained in annuli as a function of the radius of the annuli are also taken into account. These variables are respectively denoted by $E_r$ and $\Omega_r$, and they are given by the following expressions:
\begin{align}
	E_r      & = \sum_{r-\Delta r<\norm{\vf{x}}\leq r} \norm{{\vf{u}}(\vf{x})}^2  \\
	\Omega_r & = \sum_{r-\Delta r<\norm{\vf{x}}\leq r} \abs{{{\omega}}(\vf{x})}^2
\end{align}
where $r\in (\Delta r, \pi)$. The quantities $E_r$ and $\Omega_r$ are then plotted as a function of $r$ in order to study the energy and enstrophy distribution across the domain (see \cref{sec:results}).

Related to these variables are the mean energy radius and mean enstrophy radius, which denote a weighted average of the radius, intuitively representing where the majority of energy and enstrophy reside. They are defined as:
\begin{equation}
	\mathcal{R}_E^2      = \frac{\sum_{\Delta r<r\leq \pi} r^2 E_r}{\sum_{\Delta r<r\leq \pi} E_r}\quad \text{and}  \quad
	\mathcal{R}_\Omega^2 = \frac{\sum_{\Delta r<r\leq \pi} r^2 \Omega_r}{\sum_{\Delta r<r\leq \pi} \Omega_r}
\end{equation}
Note that since the domain is square, the sums $\sum_{\Delta r<r\leq \pi}  E_r$ and $\sum_{\Delta r<r\leq \pi}  \Omega_r$ are slightly less than the total energy $E$ and enstrophy $\Omega$ respectively, since they account for the contributions from the different annuli in the domain until their radii reach the radius of the incircle of the square.

Regarding the point vortex model, the system is integrable and the following function $H$
\begin{equation}
	H = \sum_{i=1}^{N} H_i,\qquad H_i = -\frac{1}{4\pi} \sum_{j\neq i} \Gamma_j \log{\norm{\vf{z}_i-\vf{z}_j}^2}
\end{equation}
is a first integral of the system. Moreover the system is Hamiltonian, that is, it can written as:
\begin{align}
	\dot{x}_i & = \pdv{H}{y_i}  \\
	\dot{y}_i & = -\pdv{H}{x_i}
\end{align}
At first sight, the reader may notice that the function $H$ is singular when two vortices get too close to each other. Although one could try to create an auxiliary function $f(H)$ that is regular in the whole domain and has a shape according the physical intuition while keeping the properties of a first integral, an alternative approach was chosen in this work to mimic the energy and enstrophy profiles for the Navier-Stokes equation.

The idea explored here involves counting the number of point vortices in annuli and comparing the density distribution $\rho_N$ with the corresponding functions $E_r$ and $\Omega_r$.

Additionally, an equivalent mean radius is defined, which gives an insight on the average location of the vortices within the domain. Its expression is given by:
\begin{equation}\label{eq:meanradius_vortices}
	\mathcal{R}_N^2 = \frac{\sum_{\Delta r<r\leq \pi} r^2 \rho_N(r)}{\sum_{\Delta r<r\leq \pi} \rho_N(r)}
\end{equation}

\end{document}
